#######################
# Aurea Central Jervis
#######################
# User guide and documentation can be found at: https://github.com/trilogy-group/central-jervis
# This project is based on https://github.com/samrocketman/jervis

language: shell

# variables are accessible from pipeline
variables:
  - MY_VAR=xyz
  - DEPLOYMENT_TARGET=docker
  
jenkins:
  stash:
    allowEmpty: true
    name: 'artifacts'
  pipeline_jenkinsfile: aurea-central-jervis/pipelines/SaaSMultiPlatform    # Type of pipeline
  collect: []
    
env:
  global:
    - VUEJS_APP_IMAGE_BASE_URL=registry2.swarm.devfactory.com/aurea/central/jervis/server/spring-boot-vuejs-app
    - DOCKER_HOST=tcp://dlb1.aureacentral.com:2375
    
docker-agents:
  - docker-image: rowanto/docker-java8-mvn-nodejs-npm
    labels: vuejs-app
    
script: 
  - echo "Hello World."
  - echo docker build -t ${VUEJS_APP_IMAGE_BASE_URL}:${GIT_COMMIT} .
  
services:
  vuejs-app:                                                                                    #   Identifier for the docker image
    docker_image:                      
     path: .                                                                                    #   Location of the Dockerfile. Default is root folder of the project
     name: registry2.swarm.devfactory.com/aurea/central/jervis/server/spring-boot-vuejs-app    #   Name of the image. Needs to include the registry URL.
                                                                                               #   Full image name will be registry2.swarm.devfactory.com/aurea/central/jervis/petclinic:TAG-BRANCH_SUFFIX
  

branches:
  only:
  - master
  - qa
  - develop
  - release
  - hotfix
  - /^feature\/.*$/
